---
title: "Reproducible Research project 1"
author: "Roderic Reckley"
date: "February 7, 2016"
output: html_document
---


## Loading and preprocessing the data
```{r}
library(ggplot2)
library(lattice)
setwd("C:/Users/RNRECKLEY/Downloads/coursera/datascience/reproducible/project1")
activity_data <- read.csv("activity.csv")
activity_data$date <- as.Date(activity_data$date)
```


```{r, echo=FALSE}
print(paste("The total number of observations found in the activity data set is : ", nrow(activity_data)))
```

You can also embed plots, for example:

## What is mean total number of steps taken per day?

```{r}
cleaned_data <- na.omit(activity_data)
```

```{r, echo=FALSE}
print(paste("The number of observations left in the  activity data set after removing those with missing values is : ", nrow(cleaned_data)))
```



```{r, echo=FALSE}
plot1 <- ggplot(cleaned_data, aes(date, steps)) 
plot1 <- plot1 + geom_bar(stat = "identity") +
     labs(title = "Histogram of Total Number of Steps Taken Each Day\n with missing values removed", x = "Date", y = "Total number of steps")
print(plot1)
```

```{r}
sum_data <- aggregate(activity_data$steps, by=list(activity_data$date), FUN=sum, na.rm=TRUE)
names(sum_data) <- c("Date", "TotalSteps")
```


#### Find the mean and medial values of the activity data set.
```{r, echo=FALSE}
print(paste("The mean number of steps taken per day with missing data is ", round(mean(sum_data$TotalSteps))))

print(paste("The median number of steps taken per with the missing data is ", round(median(sum_data$TotalSteps))))
```


```{r}
cleaned_sum_data <- aggregate(cleaned_data$steps, by=list(cleaned_data$date), FUN=sum, na.rm=TRUE)
names(cleaned_sum_data) <- c("Date", "TotalSteps")
```

```{r, echo=FALSE}
print(paste("The mean number of steps taken per day without the missing data is ", round(mean(cleaned_sum_data$TotalSteps))))

print(paste("The median number of steps taken per without the missing data is ", round(median(cleaned_sum_data$TotalSteps))))
```




## What is the average daily activity pattern?
```{r}
avg_daily <- aggregate(cleaned_data$steps, list(interval = as.numeric(as.character(cleaned_data$interval))), FUN = "mean")
names(avg_daily)[2] <- "AverageSteps"

```


```{r, echo=FALSE}
plot2 <- ggplot(avg_daily, aes(x=interval, y=AverageSteps)) +   
  geom_line(color="red", size=1) +  
  labs(title="Average Daily Activity", x=" Time Interval (5-minutes)", y="Number of steps") +  
  theme_bw()
print(plot2)

```

```{r}
max_interval <- avg_daily[which.max(avg_daily$AverageSteps),]
print(max_interval)
```

## Imputing missing values
```{r}
sum(is.na(activity_data))
imputed_activity <- merge(activity_data, avg_daily, by="interval")
missing_values <- which(is.na(imputed_activity$steps))
imputed_activity$steps[missing_values] <- imputed_activity$AverageSteps[missing_values]
imputed_activity <- imputed_activity[,c(1:3)]
sum(is.na(imputed_activity))

```


```{r, echo=FALSE}
plot3 <- ggplot(imputed_activity, aes(date, steps)) 
plot3 <- plot3 + geom_bar(stat = "identity") +
  labs(title = "Histogram of Total Number of Steps Taken Each Day\n with missing value replaced by mean
      ", x = "Date", y = "Total number of steps")
print(plot3)

```

```{r}
imputed_steps_taken <- aggregate(imputed_activity$steps, by=list(imputed_activity$date), FUN=sum)
names(imputed_steps_taken) <- c("Date", "TotalSteps")

```

#### Find the mean and medial values of the activity data after imputing the missing data.
```{r, echo=FALSE}
print(paste("The mean number of steps taken per day after imputing the missing data is ", round(mean(imputed_steps_taken$TotalSteps))))

print(paste("The median number of steps taken per day after imputing the missing data is ", round(median(imputed_steps_taken$TotalSteps))))

```


## Are there differences in activity patterns between weekdays and weekends?
```{r}
imputed_activity$Day <- factor(format(imputed_activity$date, "%A"))
levels(imputed_activity$Day)
levels(imputed_activity$Day) <- list(weekday = c("Monday", "Tuesday","Wednesday","Thursday", "Friday"),
                                 weekend = c("Saturday", "Sunday"))
levels(imputed_activity$Day)
table(imputed_activity$Day)

steps_taken_by_day <- aggregate(imputed_activity$steps,
                                list(interval= as.numeric(as.character(imputed_activity$interval)),
                                     weekdays = imputed_activity$Day), FUN = "mean")

names(steps_taken_by_day)[3] <- "AvgSteps"


```



```{r, echo=FALSE}
plot4 <- xyplot(steps_taken_by_day$AvgSteps ~ steps_taken_by_day$interval | steps_taken_by_day$weekdays, 
                layout = c(1, 2), type = "l", 
                xlab = "Interval", ylab = "Average Number of steps")
print(plot4)
```




Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
